---
title: "READ_ME"
author: "AÃ¯ssa Morin"
date: "`r Sys.Date()`"
output:
  html_document:
    toc: true
    toc_depth: 6
    toc_float: true
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, 
                      message = FALSE, 
                      warning = FALSE) 
                      # cache = FALSE) 
```

```{r}

library(kableExtra)
require(tidyverse)
require(here)
require(ggplot2)
require(readr)

```

## Data preparation

N.B: Copy of the original data from Yolan are in Chapter_2_Dryness... -> documents --> Donnees_Yolan --> Donnee_Yolan_05-2023--> 'Data_Fat_analyses_Yolan'

Original dataset was modified and saved under 'Data_Fat_analyses_raw' in 'Chapter2.Dryness. ... '--> data --> 'Data_Fat_analyses_raw'

Modifications (manual because color coded) on xlxs file -->  column addition: 'collection_interval, values (i.e. Yolan color code)) :  

+ blue  --> early : sample collected within 6 days, 
+ yellow -->  intermediate : sample collected between 6 and 8 days (included ?), 
+ red --> late : sample collected after 8 days (should be exclude from analyses)

Saved as a csv file for R processing 

__Read data__

use function 'read_fat_data_raw()' to read csv file with raw fat data from Yolan

__Clean dataset__

Aim at cleaning, organising and only keep necessary info from fat raw data using the function 'clean_raw_fat_data'

The function :  

+ removes all 'mass_Jxx' columns, 
+ removes columns: "samples_marrow_fat_rate", "samples_marrow_fat_rate_without_residuals", "bone_marrow_fat_rate_mean", "bone_marrow_fat_rate_mean_without_residuals","estimated_bc","estimated_bc_without_residuals",  "comments" and any columns after,
+ removes all replicated samples tested after J-9, etc... /ex 'Hip_B_046-J12'
+ removes empty raws after 233rd row
+ removes raws corresponding to Buffalo_01 --> a test sample that wasn't harvested following the study design (but opportunistically) and  must, thus, be excluded because it wasn't
+ removes raws corresponding to hyena's data or with no information on predator species (NA)

__Save cleaned dataset__

Aim at saving cleaned data for fat analyses 'save_cleaned_data'

The function takes 2 arguments :   

+  _cleaned_data_ : cleaned raw data for fat analyses (after using clean_raw_fat_data function)
+ _filename_ : the name we want the dataset to be saved under

The cleaned dataset is saved under ./output/clean_fat_data/ 

<br>
<br>

## Data Exploration 
<br>

__Within samples variation__

<br>

Graphical representation of the spread/distribution of dry-mass values for each sample (Hip_B_...etc)
<br>
```{r, echo=FALSE, out.width="100%",fig.align = 'center', fig.cap="Survey map"}

knitr::include_graphics(here::here("output","data_exploration","sample_dry_mass_boxplot.jpg"))

```
<br>
<br>

Table with coefficients of variation calculated per sample
<br>
<br>

```{r, echo = FALSE}

readr::read_csv2(here::here("output","data_exploration", "CV_dry_mass_table.csv")) %>% 
 kableExtra::kbl() %>% 
   kableExtra::kable_styling() %>% 
   kableExtra::scroll_box(width = "100%", height = "250px")


```

<br>
CV < 1 i.e. SD < mean --> relatively low variability ?
https://statisticsbyjim.com/basics/coefficient-variation/ 
